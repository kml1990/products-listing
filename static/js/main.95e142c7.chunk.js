(this.webpackJsonppoq=this.webpackJsonppoq||[]).push([[0],{45:function(t,e,n){},46:function(t,e,n){},47:function(t,e,n){},48:function(t,e,n){},49:function(t,e,n){},50:function(t,e,n){},51:function(t,e,n){},52:function(t,e,n){},97:function(t,e,n){},98:function(t,e,n){"use strict";n.r(e);var r=n(1),c=n.n(r),o=n(35),i=n.n(o),a=(n(42),n(13)),u=n(18),s=n(0),d=Object(r.createContext)(null),l=function(t){var e=t.children,n=t.container;return Object(s.jsx)(d.Provider,{value:n,children:e})};var h={ProductService:Symbol.for("ProductService")},f=n(3),b=n(4),j=function(){function t(){Object(f.a)(this,t)}return Object(b.a)(t,null,[{key:"mapValuesToArray",value:function(t){return Array.from(t.values())}},{key:"setToArray",value:function(t){return Array.from(t)}}]),t}(),v={products:[],selectedProducts:new Set,onProductSelected:u.noop,onProductsRemoved:u.noop},m=Object(r.createContext)(v),p=function(t){var e=t.children,n=function(t){var e=Object(r.useContext)(d);if(null===e)throw new Error("The dependency container should be defined");return e.get(t)}(h.ProductService),c=Object(r.useState)([]),o=Object(a.a)(c,2),i=o[0],u=o[1],l=Object(r.useState)(new Set),f=Object(a.a)(l,2),b=f[0],v=f[1];Object(r.useEffect)((function(){var t=!0;return n.getProducts().then((function(e){t&&u(e)})),function(){t=!1}}),[]);var p={products:i,selectedProducts:b,onProductSelected:function(t){b.has(t)?function(t){var e=j.setToArray(b).filter((function(e){return e!==t}));v(new Set(e))}(t):function(t){v((function(e){return new Set(e.add(t))}))}(t)},onProductsRemoved:function(){u(n.removeProducts(j.setToArray(b))),v(new Set)}};return Object(s.jsx)(m.Provider,{value:p,children:e})};function O(){return Object(r.useContext)(m)}var _=function(){function t(){Object(f.a)(this,t)}return Object(b.a)(t,null,[{key:"toGBP",value:function(t){return t.toLocaleString("en-UK",{style:"currency",currency:"GBP"})}}]),t}(),k=(n(45),function(t){var e=t.image,n=t.imageBadge,r=t.className,c=t.children;return Object(s.jsxs)("div",{className:"Card ".concat(r),children:[Object(s.jsx)("div",{className:"Card__image",style:{backgroundImage:"url(".concat(e,")")},children:n&&Object(s.jsx)("span",{className:"Card__imageBadge",children:n})}),Object(s.jsx)("div",{className:"Card__content",children:c})]})}),y=(n(46),function(t){var e=t.id,n=t.onSelected,c=t.className,o=void 0===c?"":c,i=Object(r.useState)(!1),u=Object(a.a)(i,2),d=u[0],l=u[1],h=Object(r.useCallback)((function(){n(!d),l(!d)}),[d]);return Object(s.jsxs)("label",{className:"Selector ".concat(o),htmlFor:e,children:[Object(s.jsx)("input",{className:"Selector__input",id:e,type:"checkbox",checked:d,onChange:h}),Object(s.jsx)("span",{className:"Selector__checkmark"})]})}),P=(n(47),n(48),function(t){var e=t.product,n=e.available,r=e.quantity,c=e.lowOnStock;if(!n||0===r)return Object(s.jsx)("span",{className:"ProductStock__stockOut",children:"Out of stock"});var o=Object(s.jsx)("span",{className:"ProductStock__stockQuantity",children:"".concat(r," in stock")});return c?Object(s.jsxs)(s.Fragment,{children:[o,Object(s.jsx)("span",{className:"ProductStock__stockLow",children:"Low on stock"})]}):o}),x=function(t){var e=t.product,n=O().onProductSelected,r=e.id,c=e.name,o=e.price,i=e.thumbnail,a=e.promotionBadge,u=o.current,d=o.old;return Object(s.jsxs)(k,{className:"ProductListItem",image:i,imageBadge:a,children:[Object(s.jsx)(y,{className:"ProductListItem__selector",id:r.toString(),onSelected:function(){return n(r)}}),Object(s.jsx)("h3",{className:"ProductListItem__name",children:c}),Object(s.jsxs)("h4",{className:"ProductListItem__price",children:[Object(s.jsx)("span",{className:"ProductListItem__currentPrice",children:_.toGBP(u)}),o.isDiscounted()&&Object(s.jsx)("span",{className:"ProductListItem__oldPrice",children:_.toGBP(d)})]}),Object(s.jsx)(P,{product:e})]})},g=(n(49),function(){var t=O().products;return Object(s.jsx)("div",{className:"ProductList",children:t.map((function(t){return Object(s.jsx)(x,{product:t},t.id)}))})}),S=(n(50),function(t){var e=t.name,n=t.onClick;return Object(s.jsx)("button",{className:"Button",type:"button",onClick:n,children:e})}),w=(n(51),function(){var t=O(),e=t.selectedProducts,n=t.onProductsRemoved;return Object(s.jsxs)("div",{className:"Inventory",children:[Object(s.jsx)(S,{name:"Remove ".concat(e.size," selected products"),onClick:n}),Object(s.jsx)(g,{})]})}),N=(n(52),function(){return Object(s.jsx)(p,{children:Object(s.jsx)(w,{})})}),B=n(36),C=n(11),L=n.n(C),q=n(14),A=function(){function t(e){Object(f.a)(this,t),this._products=void 0,this._productProvider=void 0,this._productProvider=e,this._products=new Map}return Object(b.a)(t,[{key:"getProducts",value:function(){var t=Object(q.a)(L.a.mark((function t(){var e=this;return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._productProvider.fetchProducts();case 2:return t.sent.forEach((function(t){e._products.set(t.id,t)})),t.abrupt("return",j.mapValuesToArray(this._products));case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"removeProducts",value:function(t){var e=this;return t.forEach((function(t){e._products.delete(t)})),j.mapValuesToArray(this._products)}}]),t}(),I=n(37),T=n.n(I),E=function(){function t(e){var n=e.id,r=e.name,c=e.price,o=e.available,i=e.quantity,a=e.lowOnStock,u=e.promotionBadge,s=e.thumbnail;Object(f.a)(this,t),this._id=void 0,this._name=void 0,this._price=void 0,this._available=void 0,this._quantity=void 0,this._lowOnStock=void 0,this._thumbnail=void 0,this._promotionBadge=void 0,this._id=n,this._name=r,this._price=c,this._available=o,this._quantity=i,this._lowOnStock=a,this._promotionBadge=u||"",this._thumbnail=s}return Object(b.a)(t,[{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"price",get:function(){return this._price}},{key:"available",get:function(){return this._available}},{key:"quantity",get:function(){return this._quantity}},{key:"lowOnStock",get:function(){return this._lowOnStock}},{key:"promotionBadge",get:function(){return this._promotionBadge}},{key:"thumbnail",get:function(){return this._thumbnail}}]),t}(),R=function(){function t(e){var n=e.current,r=e.old;Object(f.a)(this,t),this._current=void 0,this._old=void 0,this._current=n,this._old=r||n}return Object(b.a)(t,[{key:"current",get:function(){return this._current}},{key:"old",get:function(){return this._old}},{key:"isDiscounted",value:function(){return this._current<this._old}}]),t}(),G=function(){function t(){Object(f.a)(this,t)}return Object(b.a)(t,[{key:"parse",value:function(t){var e=this;return t.map((function(t){var n=t.productId,r=t.name,c=t.price,o=t.priceWas,i=t.available,a=t.quantity,u=t.lowOnStock,s=t.promotionBadge,d=t.imageUrl;return new E({id:n,name:r,price:new R({current:c,old:o}),available:e.isProductAvailable(i),quantity:a,lowOnStock:e.isLowOnStock(u),promotionBadge:s,thumbnail:d})}))}},{key:"isProductAvailable",value:function(t){return"TRUE"===t}},{key:"isLowOnStock",value:function(t){return"TRUE"===t}}]),t}(),U=function(){function t(){Object(f.a)(this,t),this._mockyProductParser=void 0,this._mockyProductParser=new G}return Object(b.a)(t,[{key:"fetchProducts",value:function(){var t=Object(q.a)(L.a.mark((function t(){var e;return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.a.get("https://run.mocky.io/v3/fca7ef93-8d86-4574-9a4a-3900d91a283e");case 2:if((e=t.sent).data&&200===e.status){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",this._mockyProductParser.parse(e.data));case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),V=new B.Container;V.bind(h.ProductService).toDynamicValue((function(){return new A(new U)})).inSingletonScope();var D=V;n(97);i.a.render(Object(s.jsx)(c.a.StrictMode,{children:Object(s.jsx)(l,{container:D,children:Object(s.jsx)(N,{})})}),document.getElementById("root"))}},[[98,1,2]]]);
//# sourceMappingURL=main.95e142c7.chunk.js.map