(this.webpackJsonppoq=this.webpackJsonppoq||[]).push([[0],{45:function(t,e,n){},46:function(t,e,n){},47:function(t,e,n){},48:function(t,e,n){},49:function(t,e,n){},50:function(t,e,n){},51:function(t,e,n){},52:function(t,e,n){},97:function(t,e,n){},98:function(t,e,n){"use strict";n.r(e);var c=n(1),r=n.n(c),o=n(35),i=n.n(o),a=(n(42),n(13)),u=n(18),s=n(0),d=Object(c.createContext)(null),l=function(t){var e=t.children,n=t.container;return Object(s.jsx)(d.Provider,{value:n,children:e})};var h={ProductService:Symbol.for("ProductService")},b=n(3),f=n(4),j=function(){function t(){Object(b.a)(this,t)}return Object(f.a)(t,null,[{key:"mapValuesToArray",value:function(t){return Array.from(t.values())}},{key:"setToArray",value:function(t){return Array.from(t)}}]),t}(),m={products:[],selectedProducts:new Set,onProductSelected:u.noop,onProductsRemoved:u.noop},v=Object(c.createContext)(m),p=function(t){var e=t.children,n=function(t){var e=Object(c.useContext)(d);if(null===e)throw new Error("The dependency container should be defined");return e.get(t)}(h.ProductService),r=Object(c.useState)([]),o=Object(a.a)(r,2),i=o[0],u=o[1],l=Object(c.useState)(new Set),b=Object(a.a)(l,2),f=b[0],m=b[1];Object(c.useEffect)((function(){var t=!0;return n.getProducts().then((function(e){t&&u(e)})),function(){t=!1}}),[]);var p={products:i,selectedProducts:f,onProductSelected:function(t){f.has(t)?f.delete(t):f.add(t),m(new Set(f))},onProductsRemoved:function(){u(n.removeProducts(j.setToArray(f))),m(new Set)}};return Object(s.jsx)(v.Provider,{value:p,children:e})};function O(){return Object(c.useContext)(v)}var _=function(){function t(){Object(b.a)(this,t)}return Object(f.a)(t,null,[{key:"toGBP",value:function(t){return t.toLocaleString("en-UK",{style:"currency",currency:"GBP"})}}]),t}(),k=(n(45),function(t){var e=t.image,n=t.imageBadge,c=t.className,r=t.children;return Object(s.jsxs)("div",{className:"Card ".concat(c),children:[Object(s.jsx)("div",{className:"Card__image",style:{backgroundImage:"url(".concat(e,")")},children:n&&Object(s.jsx)("span",{className:"Card__imageBadge",children:n})}),Object(s.jsx)("div",{className:"Card__content",children:r})]})}),y=(n(46),function(t){var e=t.id,n=t.onSelected,r=t.className,o=void 0===r?"":r,i=Object(c.useState)(!1),u=Object(a.a)(i,2),d=u[0],l=u[1],h=Object(c.useCallback)((function(){n(!d),l(!d)}),[d]);return Object(s.jsxs)("label",{className:"Selector ".concat(o),htmlFor:e,children:[Object(s.jsx)("input",{className:"Selector__input",id:e,type:"checkbox",checked:d,onChange:h}),Object(s.jsx)("span",{className:"Selector__checkmark"})]})}),P=(n(47),n(48),function(t){var e=t.product,n=e.available,c=e.quantity,r=e.lowOnStock;if(!n||0===c)return Object(s.jsx)("span",{className:"ProductStock__stockOut",children:"Out of stock"});var o=Object(s.jsx)("span",{className:"ProductStock__stockQuantity",children:"".concat(c," in stock")});return r?Object(s.jsxs)(s.Fragment,{children:[o,Object(s.jsx)("span",{className:"ProductStock__stockLow",children:"Low on stock"})]}):o}),x=function(t){var e=t.product,n=O().onProductSelected,r=e.id,o=e.name,i=e.price,a=e.thumbnail,u=e.promotionBadge,d=i.current,l=i.old,h=Object(c.useCallback)((function(){n(r)}),[r]);return Object(s.jsxs)(k,{className:"ProductListItem",image:a,imageBadge:u,children:[Object(s.jsx)(y,{className:"ProductListItem__selector",id:r.toString(),onSelected:h}),Object(s.jsx)("h3",{className:"ProductListItem__name",children:o}),Object(s.jsxs)("h4",{className:"ProductListItem__price",children:[Object(s.jsx)("span",{className:"ProductListItem__currentPrice",children:_.toGBP(d)}),i.isDiscounted()&&Object(s.jsx)("span",{className:"ProductListItem__oldPrice",children:_.toGBP(l)})]}),Object(s.jsx)(P,{product:e})]})},g=(n(49),function(){var t=O().products;return Object(s.jsx)("div",{className:"ProductList",children:t.map((function(t){return Object(s.jsx)(x,{product:t},t.id)}))})}),S=(n(50),function(t){var e=t.name,n=t.onClick;return Object(s.jsx)("button",{className:"Button",type:"button",onClick:n,children:e})}),w=(n(51),function(){var t=O(),e=t.selectedProducts,n=t.onProductsRemoved;return Object(s.jsxs)("div",{className:"Inventory",children:[Object(s.jsx)(S,{name:"Remove ".concat(e.size," selected products"),onClick:n}),Object(s.jsx)(g,{})]})}),N=(n(52),function(){return Object(s.jsx)(p,{children:Object(s.jsx)(w,{})})}),B=n(36),C=n(11),L=n.n(C),q=n(14),I=function(){function t(e){Object(b.a)(this,t),this._products=void 0,this._productProvider=void 0,this._productProvider=e,this._products=new Map}return Object(f.a)(t,[{key:"getProducts",value:function(){var t=Object(q.a)(L.a.mark((function t(){var e=this;return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._productProvider.fetchProducts();case 2:return t.sent.forEach((function(t){e._products.set(t.id,t)})),t.abrupt("return",j.mapValuesToArray(this._products));case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"removeProducts",value:function(t){var e=this;return t.forEach((function(t){e._products.delete(t)})),j.mapValuesToArray(this._products)}}]),t}(),A=n(37),T=n.n(A),E=function(){function t(e){var n=e.id,c=e.name,r=e.price,o=e.available,i=e.quantity,a=e.lowOnStock,u=e.promotionBadge,s=e.thumbnail;Object(b.a)(this,t),this._id=void 0,this._name=void 0,this._price=void 0,this._available=void 0,this._quantity=void 0,this._lowOnStock=void 0,this._thumbnail=void 0,this._promotionBadge=void 0,this._id=n,this._name=c,this._price=r,this._available=o,this._quantity=i,this._lowOnStock=a,this._promotionBadge=u||"",this._thumbnail=s}return Object(f.a)(t,[{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"price",get:function(){return this._price}},{key:"available",get:function(){return this._available}},{key:"quantity",get:function(){return this._quantity}},{key:"lowOnStock",get:function(){return this._lowOnStock}},{key:"promotionBadge",get:function(){return this._promotionBadge}},{key:"thumbnail",get:function(){return this._thumbnail}}]),t}(),R=function(){function t(e){var n=e.current,c=e.old;Object(b.a)(this,t),this._current=void 0,this._old=void 0,this._current=n,this._old=c||n}return Object(f.a)(t,[{key:"current",get:function(){return this._current}},{key:"old",get:function(){return this._old}},{key:"isDiscounted",value:function(){return this._current<this._old}}]),t}(),G=function(){function t(){Object(b.a)(this,t)}return Object(f.a)(t,[{key:"parse",value:function(t){var e=this;return t.map((function(t){var n=t.productId,c=t.name,r=t.price,o=t.priceWas,i=t.available,a=t.quantity,u=t.lowOnStock,s=t.promotionBadge,d=t.imageUrl;return new E({id:n,name:c,price:new R({current:r,old:o}),available:e.isProductAvailable(i),quantity:a,lowOnStock:e.isLowOnStock(u),promotionBadge:s,thumbnail:d})}))}},{key:"isProductAvailable",value:function(t){return"TRUE"===t}},{key:"isLowOnStock",value:function(t){return"TRUE"===t}}]),t}(),U=function(){function t(){Object(b.a)(this,t),this._mockyProductParser=void 0,this._mockyProductParser=new G}return Object(f.a)(t,[{key:"fetchProducts",value:function(){var t=Object(q.a)(L.a.mark((function t(){var e;return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.a.get("https://run.mocky.io/v3/fca7ef93-8d86-4574-9a4a-3900d91a283e");case 2:if((e=t.sent).data&&200===e.status){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",this._mockyProductParser.parse(e.data));case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),V=new B.Container;V.bind(h.ProductService).toDynamicValue((function(){return new I(new U)})).inSingletonScope();var D=V;n(97);i.a.render(Object(s.jsx)(r.a.StrictMode,{children:Object(s.jsx)(l,{container:D,children:Object(s.jsx)(N,{})})}),document.getElementById("root"))}},[[98,1,2]]]);
//# sourceMappingURL=main.6b2b7ae1.chunk.js.map